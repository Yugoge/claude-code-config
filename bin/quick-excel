#!/bin/bash
# Quick Excel Analyzer Wrapper
# Provides easy access to the excel-analyzer tool

EXCEL_ANALYZER="/root/excel-analyzer/analyze-excel.js"

# Check if excel-analyzer exists
if [ ! -f "$EXCEL_ANALYZER" ]; then
    echo "‚ùå Error: excel-analyzer not found at $EXCEL_ANALYZER"
    echo "Please ensure the excel-analyzer project exists."
    exit 1
fi

# Check if Node.js is available
if ! command -v node &> /dev/null; then
    echo "‚ùå Error: Node.js is not installed"
    echo "Please install Node.js to use this tool."
    exit 1
fi

# Show help if no arguments
if [ $# -eq 0 ] || [ "$1" == "--help" ] || [ "$1" == "-h" ]; then
    echo "üìä Quick Excel Analyzer - Wrapper for excel-analyzer"
    echo ""
    echo "Usage:"
    echo "  quick-excel <file.xlsx> [options]"
    echo ""
    echo "Options:"
    echo "  --formulas          Extract all formulas"
    echo "  --all              Analyze all sheets"
    echo "  --sheet <name>     Analyze specific sheet"
    echo "  --preview <num>    Preview N rows of data"
    echo "  --export <path>    Export to JSON file"
    echo ""
    echo "Examples:"
    echo "  quick-excel budget.xlsx"
    echo "  quick-excel model.xlsx --formulas"
    echo "  quick-excel data.xlsx --sheet \"Revenue\" --export revenue.json"
    echo ""
    echo "Note: This is a wrapper for /root/excel-analyzer/analyze-excel.js"
    exit 0
fi

# Run the excel analyzer
node "$EXCEL_ANALYZER" "$@"
